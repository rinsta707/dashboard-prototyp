<hcl-panel class="title-panel">{{ 'users.title-panel' | hclTranslate }}

  <button hcl-button hcl-color="primary" (click)='onAddUser()'>
    <i hcl-icon='mat::person_add'></i><span class="title-panel-button">{{ 'users.addUser' | hclTranslate }}</span>
  </button>

</hcl-panel>

<table hcl-table [hcl-data]='data' [hcl-displayed-columns]='displayedColumns' (hcl-sort-changed)="onSortChange($event)"
  hcl-sort>

  <ng-container hcl-table-column-def="username">
    <th hcl-table-header-cell *hcl-table-header-cell-def hcl-sort-header>{{ 'users.table.username' |
      hclTranslate }}</th>
    <td hcl-table-cell *hcl-table-cell-def="let _element" >
      @if (assertDataType(_element);as element) {
      {{ element.username }}
      }
    </td>
    <td hcl-table-footer-cell *hcl-table-footer-cell-def [colSpan]='displayedColumns.length'>
      <hcl-paginator [hcl-item-length]=dataLength (hcl-page-event)='onPageChange($event)'
      [hcl-page-size]=userPaginatorDefault></hcl-paginator>
    </td>

  </ng-container>

  <ng-container hcl-table-column-def="roles">
    <th hcl-table-header-cell *hcl-table-header-cell-def>{{ 'users.table.roles' | hclTranslate }} </th>
    <td hcl-table-cell *hcl-table-cell-def="let _element">
      @if (assertDataType(_element);as element) {
      <ng-container *ngFor="let role of element.roles; let last = last">{{ 'users.table.' + role | hclTranslate }}<span
          *ngIf="!last">, </span>
      </ng-container>
      }
    </td>
  </ng-container>
  <ng-container hcl-table-column-def="status">
    <th hcl-table-header-cell *hcl-table-header-cell-def>{{ 'users.table.status' | hclTranslate }}</th>
    <td hcl-table-cell *hcl-table-cell-def="let _element">
      @if (assertDataType(_element);as element) {
      {{ element.active ? ('users.table.active' | hclTranslate) : ('users.table.blocked' | hclTranslate) }}
      }
    </td>
  </ng-container>

  <ng-container hcl-table-column-def="actions" class="actions">
    <th hcl-table-header-cell *hcl-table-header-cell-def></th>
    <td hcl-table-cell *hcl-table-cell-def="let _element" style="text-align: end">
      @if (assertDataType(_element);as element) {
      <hcl-icon [hcl-icon-inline]='true' hcl-icon='mat::search' (click)='onViewUser(element)' class="action"
        title="{{ 'users.table.details' | hclTranslate }}"></hcl-icon>
      <hcl-icon [hcl-icon-inline]='true' hcl-icon='mat::edit' (click)='onEditUser(element)' class="action"
        title="{{ 'users.table.edit' | hclTranslate }}"></hcl-icon>
      <hcl-icon [hcl-icon-inline]='true' hcl-icon='mat::delete' (click)='onRemoveUser(element)' class="action"
        title="{{ 'users.table.remove' | hclTranslate }}"></hcl-icon>
      <hcl-icon [hcl-icon-inline]='true' hcl-icon='mat::lock' *ngIf="element.active" (click)='onUpdateStatus(element)'
        class="action" title="{{ 'users.table.block' | hclTranslate }}"></hcl-icon>
      <hcl-icon [hcl-icon-inline]='true' hcl-icon='mat::lock_open' *ngIf="!element.active"
        (click)='onUpdateStatus(element)' class="action" title="{{ 'users.table.unblock' | hclTranslate }}"></hcl-icon>
      }
    </td>
  </ng-container>

  <tr hcl-table-no-data-row *hcl-table-no-data-row-def>
    <td hcl-table-no-data-cell [colSpan]='displayedColumns.length'>
      <hcl-icon [hcl-icon-inline]='true' hcl-icon='mat::cancel'></hcl-icon>{{ 'users.table.empty' | hclTranslate }}
    </td>
  </tr>

  <tr hcl-table-header-row *hcl-table-header-row-def></tr>
  <tr hcl-table-row *hcl-table-row-def></tr>
  <tr hcl-table-footer-row *hcl-table-footer-row-def></tr>

</table>
<app-user-view-modal #viewUser></app-user-view-modal>
<app-add-user-modal #addUser (saveEvent)="saveUser($event)"></app-add-user-modal>
<app-edit-user-modal #editUser (saveEvent)="editUsers($event)"></app-edit-user-modal>
<app-delete-user-modal #deleteUser></app-delete-user-modal>
<app-confirm-modal #statusModal></app-confirm-modal>
